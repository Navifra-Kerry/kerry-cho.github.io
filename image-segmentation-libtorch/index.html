<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.9ba28da174dd1bb81d3b.css" id="gatsby-global-css">.rc-switch{background-color:#ccc;border:1px solid #ccc;border-radius:20px 20px;box-sizing:border-box;cursor:pointer;display:inline-block;height:22px;line-height:20px;padding:0;position:relative;transition:all .3s cubic-bezier(.35,0,.25,1);vertical-align:middle;width:44px}.rc-switch-inner{color:#fff;font-size:12px;left:24px;position:absolute;top:0}.rc-switch:after{animation-duration:.3s;animation-name:rcSwitchOff;animation-timing-function:cubic-bezier(.35,0,.25,1);background-color:#fff;border-radius:50% 50%;box-shadow:0 2px 5px rgba(0,0,0,.26);content:" ";cursor:pointer;height:18px;left:2px;position:absolute;top:1px;transform:scale(1);transition:left .3s cubic-bezier(.35,0,.25,1);width:18px}.rc-switch:hover:after{animation-name:rcSwitchOn;transform:scale(1.1)}.rc-switch:focus{box-shadow:0 0 0 2px #d5f1fd;outline:none}.rc-switch-checked{background-color:#87d068;border:1px solid #87d068}.rc-switch-checked .rc-switch-inner{left:6px}.rc-switch-checked:after{left:22px}.rc-switch-disabled{background:#ccc;border-color:#ccc;cursor:no-drop}.rc-switch-disabled:after{animation-name:none;background:#9e9e9e;cursor:no-drop}.rc-switch-disabled:hover:after{animation-name:none;transform:scale(1)}.rc-switch-label{display:inline-block;font-size:14px;line-height:20px;padding-left:10px;pointer-events:none;-webkit-user-select:text;-ms-user-select:text;user-select:text;vertical-align:middle;white-space:normal}@keyframes rcSwitchOn{0%{transform:scale(1)}50%{transform:scale(1.25)}to{transform:scale(1.1)}}@keyframes rcSwitchOff{0%{transform:scale(1.1)}to{transform:scale(1)}}@keyframes fadeInUp{0%{opacity:0;transform:translate3d(0,10%,0)}to{opacity:1;transform:translateZ(0)}}@keyframes fadeInDown{0%{opacity:0;transform:translate3d(0,-10%,0)}to{opacity:1;transform:translateZ(0)}}@keyframes fadeInLeft{0%{opacity:0;transform:translate3d(-20%,0,0)}to{opacity:1;transform:translateZ(0)}}@keyframes fadeInRight{0%{opacity:0;transform:translate3d(20%,0,0)}to{opacity:1;transform:translateZ(0)}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@media screen and (min-width:768px){.react-reveal{animation-timing-function:cubic-bezier(.77,0,.175,1)}.fadeInUp{animation-name:fadeInUp}.fadeInDown{animation-name:fadeInDown}.fadeInLeft{animation-name:fadeInLeft}.fadeInRight{animation-name:fadeInRight}.fadeIn{animation-name:fadeIn}}@media not screen and (min-width:768px){.react-reveal{opacity:1!important}}.slick-slider{-webkit-touch-callout:none;-webkit-tap-highlight-color:transparent;box-sizing:border-box;touch-action:pan-y;-webkit-user-select:none;-ms-user-select:none;user-select:none;-khtml-user-select:none}.slick-list,.slick-slider{display:block;position:relative}.slick-list{margin:0;overflow:hidden;padding:0}.slick-list:focus{outline:none}.slick-list.dragging{cursor:pointer;cursor:hand}.slick-slider .slick-list,.slick-slider .slick-track{transform:translateZ(0)}.slick-track{display:block;left:0;margin-left:auto;margin-right:auto;position:relative;top:0}.slick-track:after,.slick-track:before{content:"";display:table}.slick-track:after{clear:both}.slick-loading .slick-track{visibility:hidden}.slick-slide{display:none;float:left;height:100%;min-height:1px}[dir=rtl] .slick-slide{float:right}.slick-slide img{display:block}.slick-slide.slick-loading img{display:none}.slick-slide.dragging img{pointer-events:none}.slick-initialized .slick-slide{display:block}.slick-loading .slick-slide{visibility:hidden}.slick-vertical .slick-slide{border:1px solid transparent;display:block;height:auto}.slick-arrow.slick-hidden{display:none}.with-animation .slick-slide{opacity:1;transform:scale(1);transform-origin:left;transition:all .6s ease}.with-animation .slick-slide.slick-active+:not(.slick-active){opacity:0;transform:scale(.7)}.slick-next,.slick-prev{position:absolute;top:50%;transform:translateY(-50%);z-index:2}.slick-prev{box-shadow:-1px 1px 3px 0 rgba(1,1,1,.1);left:-15px}.slick-next{box-shadow:1px 1px 3px 0 rgba(1,1,1,.1);right:-15px}.slick-dots{display:block;list-style:none;margin:0;padding:.5rem 0 0;position:absolute;text-align:center;text-align:right;top:-4rem;width:100%}.slick-dots li{cursor:pointer;display:inline-block;margin:0 5px;padding:0;position:relative}.slick-dots li button{background:transparent;background-color:#a0aec0;border:0;border-radius:100%;cursor:pointer;display:block;font-size:0;height:12px;line-height:0px;margin:5px;outline:none;width:12px}.slick-dots li.slick-active button{background-color:#4a5568}</style><meta name="generator" content="Gatsby 3.5.0"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><title data-react-helmet="true">Image Segmentation Libtorch | Kerry Cho</title><meta data-react-helmet="true" itemProp="name" content="Image Segmentation Libtorch"/><meta data-react-helmet="true" itemProp="description" content="안녕하세요. 조대희 입니다.
블로그 방문을 환영 합니다. 이번에 소개 해드릴 내용은 PyTorch의 C++ Frontend 인 LibTorch를 활용한 Image…"/><meta data-react-helmet="true" name="description" content="안녕하세요. 조대희 입니다.
블로그 방문을 환영 합니다. 이번에 소개 해드릴 내용은 PyTorch의 C++ Frontend 인 LibTorch를 활용한 Image…"/><meta data-react-helmet="true" property="og:title" content="Image Segmentation Libtorch"/><meta data-react-helmet="true" property="og:description" content="안녕하세요. 조대희 입니다.
블로그 방문을 환영 합니다. 이번에 소개 해드릴 내용은 PyTorch의 C++ Frontend 인 LibTorch를 활용한 Image…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:site_name" content="SEMI-TS"/><meta data-react-helmet="true" property="og:image"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:site" content="SEMI-TS"/><meta data-react-helmet="true" name="twitter:title" content="Image Segmentation Libtorch"/><meta data-react-helmet="true" name="twitter:description" content="안녕하세요. 조대희 입니다.
블로그 방문을 환영 합니다. 이번에 소개 해드릴 내용은 PyTorch의 C++ Frontend 인 LibTorch를 활용한 Image…"/><meta data-react-helmet="true" name="twitter:creator" content="https://twitter.com/twitter"/><meta data-react-helmet="true" name="article:published_time" content="November 27, 2019"/><meta data-react-helmet="true" name="twitter:label1" value="Reading time"/><meta data-react-helmet="true" name="twitter:data1" value="2 min read"/><script data-react-helmet="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Image Segmentation Libtorch","datePublished":"November 27, 2019"}</script><script data-react-helmet="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"SEMI-TS"},{"@type":"ListItem","position":2,"name":"deeplearing","item":"null/category/deeplearing/"}]}</script><link crossorigin="" href="https://fonts.gstatic.com/" rel="preconnect"/><link crossorigin="" href="https://fonts.googleapis.com/" rel="preconnect"/><link as="script" rel="prefetch" href="/457-bcac643f68a97c37501e.js"/><link as="script" rel="prefetch" href="/369-26d50a3feeb5f566f288.js"/><link as="script" rel="prefetch" href="/react-slick-7b6c072f70c579f6db6c.js"/><link as="script" rel="prefetch" href="/613-d5a995b17eb385f2c614.js"/><link as="script" rel="preload" href="/webpack-runtime-5a6ba0d56af91f4a4dff.js"/><link as="script" rel="preload" href="/framework-925a264ea7071e9ed47d.js"/><link as="script" rel="preload" href="/app-50f9bf8ab9e951c20863.js"/><link as="script" rel="preload" href="/1bfc9850-8a7d264615bfa63fcb93.js"/><link as="script" rel="preload" href="/commons-cbdc30ae181bfc5ae6cc.js"/><link as="script" rel="preload" href="/8318107e3df1ad98495ee7ebb014263547905291-1cf1e072b01392ef1b6a.js"/><link as="script" rel="preload" href="/eec621bf02fd1fb8f4bc6a47ea0801ffe7676c6c-dd14562313247f8bcc61.js"/><link as="script" rel="preload" href="/component---src-templates-post-js-3ce6f4158126e723d065.js"/><link as="fetch" rel="preload" href="/page-data/image-segmentation-libtorch/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1434057858.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/1992822086.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2918496967.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4235339838.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/4240507859.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="o12to9">body{--theme-ui-colors-text:var(--theme-ui-colors-text,#718096);--theme-ui-colors-article:var(--theme-ui-colors-article,#4a5568);--theme-ui-colors-heading:var(--theme-ui-colors-heading,#2d3748);--theme-ui-colors-alphaLighter:var(--theme-ui-colors-alphaLighter,#ebf4ff);--theme-ui-colors-alphaLight:var(--theme-ui-colors-alphaLight,#a3bffa);--theme-ui-colors-alpha:var(--theme-ui-colors-alpha,#667eea);--theme-ui-colors-alphaDark:var(--theme-ui-colors-alphaDark,#5a67d8);--theme-ui-colors-alphaDarker:var(--theme-ui-colors-alphaDarker,#434190);--theme-ui-colors-betaLighter:var(--theme-ui-colors-betaLighter,#faf5ff);--theme-ui-colors-betaLight:var(--theme-ui-colors-betaLight,#d6bcfa);--theme-ui-colors-beta:var(--theme-ui-colors-beta,#9f7aea);--theme-ui-colors-betaDark:var(--theme-ui-colors-betaDark,#805ad5);--theme-ui-colors-betaDarker:var(--theme-ui-colors-betaDarker,#553c9a);--theme-ui-colors-omegaLighter:var(--theme-ui-colors-omegaLighter,#edf2f7);--theme-ui-colors-omegaLight:var(--theme-ui-colors-omegaLight,#e2e8f0);--theme-ui-colors-omega:var(--theme-ui-colors-omega,#a0aec0);--theme-ui-colors-omegaDark:var(--theme-ui-colors-omegaDark,#718096);--theme-ui-colors-omegaDarker:var(--theme-ui-colors-omegaDarker,#2d3748);--theme-ui-colors-successLight:var(--theme-ui-colors-successLight,#f0fff4);--theme-ui-colors-success:var(--theme-ui-colors-success,#48bb78);--theme-ui-colors-errorLight:var(--theme-ui-colors-errorLight,#fff5f5);--theme-ui-colors-error:var(--theme-ui-colors-error,#f56565);--theme-ui-colors-white:var(--theme-ui-colors-white,#fff);--theme-ui-colors-background:var(--theme-ui-colors-background,#f8f8f8);--theme-ui-colors-contentBg:var(--theme-ui-colors-contentBg,#fff);--theme-ui-colors-headerBg:var(--theme-ui-colors-headerBg,#fff);--theme-ui-colors-footerBg:var(--theme-ui-colors-footerBg,#fff);--theme-ui-colors-mute:var(--theme-ui-colors-mute,#e2e8f0);--theme-ui-colors-highlight:var(--theme-ui-colors-highlight,#edf2f7);color:var(--theme-ui-colors-text,#718096);background-color:var(--theme-ui-colors-background,#f8f8f8);}body.theme-ui-dark{--theme-ui-colors-alphaLighter:var(--theme-ui-colors-modes-dark-alphaLighter,#434190);--theme-ui-colors-alphaLight:var(--theme-ui-colors-modes-dark-alphaLight,#5a67d8);--theme-ui-colors-alphaDark:var(--theme-ui-colors-modes-dark-alphaDark,#a3bffa);--theme-ui-colors-alphaDarker:var(--theme-ui-colors-modes-dark-alphaDarker,#ebf4ff);--theme-ui-colors-betaLighter:var(--theme-ui-colors-modes-dark-betaLighter,#553c9a);--theme-ui-colors-betaLight:var(--theme-ui-colors-modes-dark-betaLight,#805ad5);--theme-ui-colors-betaDark:var(--theme-ui-colors-modes-dark-betaDark,#d6bcfa);--theme-ui-colors-betaDarker:var(--theme-ui-colors-modes-dark-betaDarker,#faf5ff);--theme-ui-colors-omegaLighter:var(--theme-ui-colors-modes-dark-omegaLighter,#2d3748);--theme-ui-colors-omegaLight:var(--theme-ui-colors-modes-dark-omegaLight,#718096);--theme-ui-colors-omegaDark:var(--theme-ui-colors-modes-dark-omegaDark,#e2e8f0);--theme-ui-colors-omegaDarker:var(--theme-ui-colors-modes-dark-omegaDarker,#edf2f7);--theme-ui-colors-text:var(--theme-ui-colors-modes-dark-text,#cbd5e0);--theme-ui-colors-article:var(--theme-ui-colors-modes-dark-article,#e2e8f0);--theme-ui-colors-heading:var(--theme-ui-colors-modes-dark-heading,#edf2f7);--theme-ui-colors-background:var(--theme-ui-colors-modes-dark-background,#1a202c);--theme-ui-colors-contentBg:var(--theme-ui-colors-modes-dark-contentBg,#2d3748);--theme-ui-colors-headerBg:var(--theme-ui-colors-modes-dark-headerBg,#2d3748);--theme-ui-colors-footerBg:var(--theme-ui-colors-modes-dark-footerBg,#2d3748);--theme-ui-colors-mute:var(--theme-ui-colors-modes-dark-mute,#718096);}</style><style data-emotion-css="wxng5j">*{box-sizing:border-box;}body{margin:0;font-family:'Inter',sans-serif;font-size:1rem;font-weight:normal;line-height:1.8;-webkit-font-smoothing:antialiased;-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion-css="130izn8">.css-130izn8{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-130izn8"><style data-emotion-css="12w1vdk">html{font-size:85%;}@media screen and (min-width:640px){html{font-size:90%;}}@media screen and (min-width:768px){html{font-size:95%;}}@media screen and (min-width:1024px){html{font-size:100%;}}::selection{color:var(--theme-ui-colors-white,#fff);background:var(--theme-ui-colors-omegaDark,#718096);}</style><style data-emotion-css="8quyoq">.css-8quyoq{box-sizing:border-box;margin:0;min-width:0;position:relative;background-color:var(--theme-ui-colors-headerBg,#fff);}</style><div class="css-8quyoq"><style data-emotion-css="1s3ligh">.css-1s3ligh{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem;position:relative;z-index:10;}@media screen and (min-width:640px){.css-1s3ligh{padding-left:2rem;padding-right:2rem;}}</style><div class="css-1s3ligh"><style data-emotion-css="16oqm0b">.css-16oqm0b{box-sizing:border-box;margin:0;min-width:0;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:6rem;padding-top:1rem;padding-bottom:1rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:640px){.css-16oqm0b{height:7rem;padding-top:2rem;padding-bottom:2rem;}}</style><div class="css-16oqm0b"><style data-emotion-css="1q5edj3">.css-1q5edj3{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;}@media screen and (min-width:768px){.css-1q5edj3{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;}}</style><div class="css-1q5edj3"></div><style data-emotion-css="163yhbe">.css-163yhbe{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;min-width:auto;-webkit-order:3;-ms-flex-order:3;order:3;margin-left:1rem;margin-right:1rem;}@media screen and (min-width:768px){.css-163yhbe{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-order:unset;-ms-flex-order:unset;order:unset;}}</style><div class="css-163yhbe"></div><style data-emotion-css="td4tiv">.css-td4tiv{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;min-width:auto;-webkit-order:4;-ms-flex-order:4;order:4;}@media screen and (min-width:768px){.css-td4tiv{-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;-webkit-order:unset;-ms-flex-order:unset;order:unset;}}</style><div class="css-td4tiv"><style data-emotion-css="mzyruo">.css-mzyruo{box-sizing:border-box;margin:0;min-width:0;display:none;}@media screen and (min-width:768px){.css-mzyruo{display:block;}}</style><div class="css-mzyruo"><style data-emotion-css="yo0yuz">.css-yo0yuz{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-yo0yuz"><style data-emotion-css="f5zorj">.css-f5zorj{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-weight:700;display:inline-block;color:var(--theme-ui-colors-omegaDark,#718096);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0.25rem;margin:0;margin-left:0.5rem;margin-right:0.5rem;}.css-f5zorj:hover,.css-f5zorj:focus,.css-f5zorj.active{color:primary;}.css-f5zorj:visited{color:var(--theme-ui-colors-omegaDark,#718096);}.css-f5zorj:hover{color:var(--theme-ui-colors-alpha,#667eea);}.css-f5zorj svg{display:block;margin-left:auto;margin-right:auto;margin-bottom:0.25rem;}</style><a class="css-f5zorj" href="/">Home</a><a class="css-f5zorj" href="/about">About Me</a></div></div><style data-emotion-css="13pi9m9">.css-13pi9m9{box-sizing:border-box;margin:0;min-width:0;display:block;}@media screen and (min-width:768px){.css-13pi9m9{display:none;}}</style><div class="css-13pi9m9"><style data-emotion-css="1xw2bw6">.css-1xw2bw6{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0.25rem;width:32px;height:32px;color:inherit;background-color:transparent;border:none;border-radius:4px;display:inline-block;min-width:auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;outline:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;border-radius:9999px;cursor:pointer;border-width:3px;border-style:solid;-webkit-transition:all 250ms ease;transition:all 250ms ease;box-sizing:initial;color:var(--theme-ui-colors-omega,#a0aec0);border-color:transparent;vertical-align:middle;width:24px;height:24px;padding:0.5rem;background-color:var(--theme-ui-colors-omegaLighter,#edf2f7);-webkit-transition:left 0.3s cubic-bezier(0.78,0.14,0.15,0.86);transition:left 0.3s cubic-bezier(0.78,0.14,0.15,0.86);left:-2rem;}.css-1xw2bw6 +a,.css-1xw2bw6 + button{margin-left:0.5rem;}.css-1xw2bw6 svg{width:24px;height:24px;}@media (hover:hover) and (pointer:fine){.css-1xw2bw6:hover{background-color:var(--theme-ui-colors-alpha,#667eea);color:var(--theme-ui-colors-white,#fff);}.css-1xw2bw6:hover svg{fill:var(--theme-ui-colors-white,#fff);}}.css-1xw2bw6:before{display:none;}@media screen and (min-width:768px){.css-1xw2bw6{display:none;}}</style><button aria-label="Menu" class="css-1xw2bw6"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg></button><style data-emotion-css="ifm721">.css-ifm721{box-sizing:border-box;margin:0;min-width:0;position:fixed;top:0;right:0;-webkit-transform:translate(100%,0);-ms-transform:translate(100%,0);transform:translate(100%,0);width:75%;height:100vh;background-color:var(--theme-ui-colors-contentBg,#fff);-webkit-transition:all .5s cubic-bezier(.77,0,.175,1);transition:all .5s cubic-bezier(.77,0,.175,1);z-index:99;}.css-ifm721 open{-webkit-transform:translate(0,0);-ms-transform:translate(0,0);transform:translate(0,0);box-shadow:0 0 45px 0 rgba(0,0,0,.25);}</style><div class="css-ifm721"><style data-emotion-css="kovx41">.css-kovx41{box-sizing:border-box;margin:0;min-width:0;position:relative;height:100%;z-index:2;background-color:var(--theme-ui-colors-contentBg,#fff);overflow-y:scroll;font-size:1.25rem;padding:4rem;}</style><div class="css-kovx41"></div></div><style data-emotion-css="1ylv1n">.css-1ylv1n{box-sizing:border-box;margin:0;min-width:0;position:fixed;top:0;right:100%;width:100%;height:100%;background-color:#222;opacity:0;-webkit-transition:opacity .5s cubic-bezier(.77,0,.175,1);transition:opacity .5s cubic-bezier(.77,0,.175,1);z-index:90;}</style><div class="css-1ylv1n"></div></div></div><style data-emotion-css="w1ne5u">.css-w1ne5u{box-sizing:border-box;margin:0;min-width:0;min-width:auto;-webkit-order:2;-ms-flex-order:2;order:2;}@media screen and (min-width:768px){.css-w1ne5u{-webkit-order:unset;-ms-flex-order:unset;order:unset;}}</style><div class="css-w1ne5u"><style data-emotion-css="vurnku">.css-vurnku{box-sizing:border-box;margin:0;min-width:0;}</style><div class="css-vurnku"><style data-emotion-css="ipwkuf">.css-ipwkuf{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0.25rem;width:32px;height:32px;color:inherit;background-color:transparent;border:none;border-radius:4px;display:inline-block;min-width:auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;outline:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;border-radius:9999px;cursor:pointer;border-width:3px;border-style:solid;-webkit-transition:all 250ms ease;transition:all 250ms ease;box-sizing:initial;color:var(--theme-ui-colors-omega,#a0aec0);border-color:transparent;vertical-align:middle;width:24px;height:24px;padding:0.5rem;background-color:var(--theme-ui-colors-omegaLighter,#edf2f7);display:block;}.css-ipwkuf +a,.css-ipwkuf + button{margin-left:0.5rem;}.css-ipwkuf svg{width:24px;height:24px;}@media (hover:hover) and (pointer:fine){.css-ipwkuf:hover{background-color:var(--theme-ui-colors-alpha,#667eea);color:var(--theme-ui-colors-white,#fff);}.css-ipwkuf:hover svg{fill:var(--theme-ui-colors-white,#fff);}}.css-ipwkuf:before{display:none;}@media screen and (min-width:768px){.css-ipwkuf{display:none;}}</style><button aria-label="Toggle dark mode" class="css-ipwkuf"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path></svg></button><style data-emotion="css 1959dbc">.css-1959dbc{display:none;}@media screen and (min-width: 52em){.css-1959dbc{display:block;}}.css-1959dbc.rc-switch{background:linear-gradient(45deg, #FF7D6B, #FFD64C);border:0;width:50px;height:24px;}.css-1959dbc.rc-switch:focus{box-shadow:none;}.css-1959dbc.rc-switch-checked{background:linear-gradient(45deg, #3366FF, #AC15B8);border:0;}.css-1959dbc.rc-switch:after{width:21px;height:21px;}.css-1959dbc.rc-switch-checked:after{left:auto;right:2px;}.css-1959dbc .rc-switch-inner{font-size:unset;top:1px;left:26px;}.css-1959dbc.rc-switch-checked .rc-switch-inner{left:7px;}</style><button aria-label="Toggle dark mode" type="button" role="switch" aria-checked="false" class="rc-switch css-1959dbc"><span class="rc-switch-inner"><style data-emotion="css uk6cul">.css-uk6cul{vertical-align:middle;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-uk6cul" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M256 160c-52.9 0-96 43.1-96 96s43.1 96 96 96 96-43.1 96-96-43.1-96-96-96zm246.4 80.5l-94.7-47.3 33.5-100.4c4.5-13.6-8.4-26.5-21.9-21.9l-100.4 33.5-47.4-94.8c-6.4-12.8-24.6-12.8-31 0l-47.3 94.7L92.7 70.8c-13.6-4.5-26.5 8.4-21.9 21.9l33.5 100.4-94.7 47.4c-12.8 6.4-12.8 24.6 0 31l94.7 47.3-33.5 100.5c-4.5 13.6 8.4 26.5 21.9 21.9l100.4-33.5 47.3 94.7c6.4 12.8 24.6 12.8 31 0l47.3-94.7 100.4 33.5c13.6 4.5 26.5-8.4 21.9-21.9l-33.5-100.4 94.7-47.3c13-6.5 13-24.7.2-31.1zm-155.9 106c-49.9 49.9-131.1 49.9-181 0-49.9-49.9-49.9-131.1 0-181 49.9-49.9 131.1-49.9 181 0 49.9 49.9 49.9 131.1 0 181z"></path></svg></span></button></div></div></div></div></div><style data-emotion-css="1qe1pxe">.css-1qe1pxe{box-sizing:border-box;margin:0;min-width:0;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;}</style><div class="css-1qe1pxe"><style data-emotion-css="1b24wpc">.css-1b24wpc{box-sizing:border-box;margin:0;min-width:0;min-width:auto;border-top-style:solid;border-top-color:transparent;border-top-width:2px;height:0;margin-top:1rem;margin-bottom:1rem;}@media screen and (min-width:640px){.css-1b24wpc{margin-top:2rem;margin-bottom:2rem;}}</style><div class="css-1b24wpc"></div><style data-emotion-css="bh18vc">.css-bh18vc{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;max-width:1140px;padding-left:1rem;padding-right:1rem;}@media screen and (min-width:640px){.css-bh18vc{padding-left:2rem;padding-right:2rem;}}</style><div class="css-bh18vc"><style data-emotion-css="4p9r15">.css-4p9r15{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;max-width:none;}</style><div class="css-4p9r15"><style data-emotion-css="4cffwv">.css-4cffwv{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-4cffwv"><div><style data-emotion-css="19bg7qi">.css-19bg7qi{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:900;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1.875rem;}@media screen and (min-width:640px){.css-19bg7qi{font-size:2.25rem;}}@media screen and (min-width:1024px){.css-19bg7qi{font-size:3rem;}}</style><h1 class="css-19bg7qi">Image Segmentation Libtorch<!-- --> </h1><style data-emotion-css="1mqovrv">.css-1mqovrv{box-sizing:border-box;margin:0;min-width:0;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1rem;font-weight:normal;color:var(--theme-ui-colors-omegaDark,#718096);margin-bottom:0;}</style><div class="css-1mqovrv"><style data-emotion-css="dwcav6">.css-dwcav6{box-sizing:border-box;margin:0;min-width:0;}.css-dwcav6 > *:not(:last-child) + *:before{content:" ・ ";}</style><div class="css-dwcav6"><style data-emotion-css="12hibeq">.css-12hibeq{box-sizing:border-box;margin:0;min-width:0;display:inline-block;}</style><div class="css-12hibeq">By <style data-emotion-css="x0ewr6">.css-x0ewr6{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-omegaDark,#718096);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-x0ewr6:visited{color:var(--theme-ui-colors-omegaDark,#718096);}.css-x0ewr6:hover{color:var(--theme-ui-colors-alpha,#667eea);}</style><a class="css-x0ewr6" href="/author/kerry-cho/"><strong>Kerry Cho</strong></a></div><div class="css-12hibeq">Published in <a class="css-x0ewr6" href="/category/deeplearing/"><strong>deeplearing</strong></a></div><div class="css-12hibeq">November 27, 2019</div><style data-emotion-css="15yawki">.css-15yawki{box-sizing:border-box;margin:0;min-width:0;display:inline-block;color:var(--theme-ui-colors-error,#f56565);}</style><div class="css-15yawki"><strong>2<!-- --> min read</strong></div></div></div></div></div></div></div><div class="css-1b24wpc"></div><div class="css-bh18vc"><div class="css-4p9r15"><div class="css-4cffwv"><style data-emotion-css="1o15qec">.css-1o15qec{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;-webkit-flex:1;-ms-flex:1;flex:1;margin-left:0;}</style><div class="css-1o15qec"><style data-emotion-css="1yus8ce">.css-1yus8ce{box-sizing:border-box;margin:0;min-width:0;background-color:var(--theme-ui-colors-contentBg,#fff);border-radius:1rem;-webkit-transition: -webkit-transform 250ms ease, box-shadow 250ms ease, color 250ms ease;-webkit-transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;box-shadow:1px 1px 5px 0 rgba(1,1,1,.05);padding:2rem;}</style><div class="css-1yus8ce"><style data-emotion="css 13j2nrx">.css-13j2nrx{min-height:23rem;margin-top:-32px;margin-left:-32px;margin-right:-32px;}.css-13j2nrx img{border-radius:0 0 0 0;}</style><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-13j2nrx"><div style="max-width:1600px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;650&#x27; width=&#x27;1600&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#181818;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="/static/ae32ed553a4f4e890f82b95f87388ee3/dd444/image.webp 800w,/static/ae32ed553a4f4e890f82b95f87388ee3/68ede/image.webp 1600w" sizes="(min-width: 1600px) 1600px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1600px) 1600px, 100vw" decoding="async" loading="lazy" data-src="/static/ae32ed553a4f4e890f82b95f87388ee3/b104e/image.jpg" data-srcset="/static/ae32ed553a4f4e890f82b95f87388ee3/2c034/image.jpg 800w,/static/ae32ed553a4f4e890f82b95f87388ee3/b104e/image.jpg 1600w" alt="Image Segmentation Libtorch"/></picture><noscript><picture><source type="image/webp" srcSet="/static/ae32ed553a4f4e890f82b95f87388ee3/dd444/image.webp 800w,/static/ae32ed553a4f4e890f82b95f87388ee3/68ede/image.webp 1600w" sizes="(min-width: 1600px) 1600px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1600px) 1600px, 100vw" decoding="async" loading="lazy" src="/static/ae32ed553a4f4e890f82b95f87388ee3/b104e/image.jpg" srcSet="/static/ae32ed553a4f4e890f82b95f87388ee3/2c034/image.jpg 800w,/static/ae32ed553a4f4e890f82b95f87388ee3/b104e/image.jpg 1600w" alt="Image Segmentation Libtorch"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><style data-emotion-css="8s19zc">.css-8s19zc{box-sizing:border-box;margin:0;min-width:0;min-width:auto;border-top-style:solid;border-top-color:transparent;border-top-width:2px;height:0;margin-top:0.5rem;margin-bottom:0.5rem;}@media screen and (min-width:640px){.css-8s19zc{margin-top:1rem;margin-bottom:1rem;}}</style><div class="css-8s19zc"></div><style data-emotion-css="1jg7uzx">.css-1jg7uzx{padding:0;margin:0;margin-bottom:2rem;color:var(--theme-ui-colors-article,#4a5568);font-size:1.25rem;padding:0;margin:0;margin-bottom:2rem;color:var(--theme-ui-colors-article,#4a5568);font-size:1.25rem;}.css-1jg7uzx code{font-size:inherit;}.css-1jg7uzx code{font-size:inherit;}</style><p class="css-1jg7uzx">안녕하세요. 조대희 입니다.
블로그 방문을 환영 합니다.</p><p class="css-1jg7uzx">이번에 소개 해드릴 내용은 PyTorch의 C++ Frontend 인 LibTorch를 활용한 Image Segmentation을 하는 법에 대한 내용 입니다.
모든 소스는 <style data-emotion-css="wa7nh6">.css-wa7nh6{color:var(--theme-ui-colors-alpha,#667eea);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--theme-ui-colors-alpha,#667eea);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-wa7nh6:visited{color:var(--theme-ui-colors-alpha,#667eea);}.css-wa7nh6:hover{color:var(--theme-ui-colors-alphaDark,#5a67d8);}.css-wa7nh6:visited{color:var(--theme-ui-colors-alpha,#667eea);}.css-wa7nh6:hover{color:var(--theme-ui-colors-alphaDark,#5a67d8);}</style><a href="https://github.com/kerry-Cho/SemanticSegmentation-Libtorch" class="css-wa7nh6">여기</a> 저장소에 있습니다. </p><p class="css-1jg7uzx">본 포스트를 읽기 전 사전에 고전적인 Image Segmentation과 Image Processing에 대한 기초 지식이 필요 합니다.
해당 내용을 제가 설명 해드리는 것 보다, 전문적인 강의를 추천 드립니다. </p><p class="css-1jg7uzx">Microsoft에서는 무료 강의와 도큐먼트를 잘만들기로 유명 한데요 (저만 그렇게 생각하나요?) 정말 이렇게 해도 되나 싶은데
PyTorch 포스팅을 하면서 Microsoft에서 만든 무료 교육을 추천 드립니다. 1달간 무료로 시청 하실 수 있는 것으로 알고 있고,
해당 사이트의 경우 인증서 같은 것을 발급해 주는데 그것을 받기 위해서 일정의 돈을 지급해야 하는 것으로 알고 있습니다. </p><p class="css-1jg7uzx">지금 추천드리는 강의보다 좋은 것들이 많이 있으니 공부 하실때 참고 하면 좋을것 같습니다.. 사이트 주소는 <a href="https://courses.edx.org/courses/course-v1:Microsoft+DEV290x+3T2019/course/" class="css-wa7nh6">여기</a> 입니다. 아 그리고 사이트의 강의는 영어로 진행 됩니다. 영어 울렁증이 있으신 분들에게는 죄송합니다…</p><p class="css-1jg7uzx">그럼 시작하겠습니다.</p><style data-emotion-css="1ub9cvv">.css-1ub9cvv{padding:0;margin:0;margin-bottom:2rem;font-size:1.875rem;font-family:'Inter',sans-serif;line-height:1.33;font-weight:900;display:block;color:var(--theme-ui-colors-heading,#2d3748);-webkit-text-decoration:none;text-decoration:none;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:var(--theme-ui-colors-omegaLight,#e2e8f0);padding-bottom:1rem;}@media screen and (min-width:640px){.css-1ub9cvv{font-size:2.25rem;}}@media screen and (min-width:1024px){.css-1ub9cvv{font-size:3rem;}}</style><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h1 id="introdution" class="css-1ub9cvv css-og3soz"><style data-emotion-css="10kjd3a">.css-10kjd3a{box-sizing:border-box;margin:0;min-width:0;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:900;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1.875rem;position:relative;}@media screen and (min-width:640px){.css-10kjd3a{font-size:2.25rem;}}@media screen and (min-width:1024px){.css-10kjd3a{font-size:3rem;}}</style><a href="#introdution" class="css-10kjd3a">Introdution<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h1><p class="css-1jg7uzx">딥러닝을 이용한 Python 예제는 <a href="https://github.com/mrgloom/awesome-semantic-segmentation" class="css-wa7nh6">여기</a>에서 찾아 보실 수 있습니다.
해당 사이트에 많은 예제들이 있지만 저는 PyTorch를 사용 했기 때문에 TorchVision Reference를 참고 하여 LibTorch 만들어 보았습니다.</p><p class="css-1jg7uzx">그리고 데이터 셋의 소스는 <a href="https://github.com/lsrock1/maskrcnn_benchmark.cpp" class="css-wa7nh6">이친구</a>의 소스를 참고해서 제가 사용하기 편한 방법으로 변경 하였습니다.
위의 친구가 지금 열심히 MaskRCNN LibTorch 버전을 만들고 있던데 다 만들어 지면 저것 또한 리뷰를 하는 시간을 가져 볼께요…아니면 제가 만들어서!!?</p><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h1 id="install-dependency" class="css-1ub9cvv css-og3soz"><a href="#install-dependency" class="css-10kjd3a">Install Dependency<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h1><p class="css-1jg7uzx">의존성 파일들은 <a href="https://kerry-cho.github.io/TransferLearning-Libtorch/" class="css-wa7nh6">TransferLearning</a> 포스트를 참고 하시면 됩니다.</p><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h1 id="network-model" class="css-1ub9cvv css-og3soz"><a href="#network-model" class="css-10kjd3a">Network Model<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h1><style data-emotion-css="16v5hhi">.css-16v5hhi{padding:0;margin:0;margin-bottom:2rem;list-style-position:outside;list-style-image:none;margin-left:1rem;padding:0;margin:0;margin-bottom:2rem;list-style-position:outside;list-style-image:none;margin-left:1rem;}</style><ul class="css-16v5hhi"><style data-emotion-css="n4urzb">.css-n4urzb{margin-bottom:0.5rem;padding-left:0;color:var(--theme-ui-colors-article,#4a5568);font-size:1.25rem;margin:0;margin-bottom:0.5rem;padding-left:0;color:var(--theme-ui-colors-article,#4a5568);font-size:1.25rem;margin:0;}.css-n4urzb ol{margin-top:0.5rem;margin-bottom:0.5rem;margin-left:1rem;}.css-n4urzb ul{margin-top:0.5rem;margin-bottom:0.5rem;margin-left:1rem;}.css-n4urzb p{margin-bottom:0.5rem;}.css-n4urzb code{font-size:inherit;}.css-n4urzb ol{margin-top:0.5rem;margin-bottom:0.5rem;margin-left:1rem;}.css-n4urzb ul{margin-top:0.5rem;margin-bottom:0.5rem;margin-left:1rem;}.css-n4urzb p{margin-bottom:0.5rem;}.css-n4urzb code{font-size:inherit;}</style><li class="css-n4urzb">Backbone<br/>Backbone 같은 경우 TorchVision의 Resnet 모델 가져와서 조금 수정 하였습니다. Segmentation의 경우 Dilate Convolution을 진행 해야 하고
모듈 전체를 가져와 하나의 네트웍으로 구성 해야 하기 때문에 수정을 진행 했습니다.
물론 Python 모델과 호환이 되게끔 수정 했습니다. </li></ul><p class="css-1jg7uzx">중요한 내용은 아래와 같습니다.</p><style data-emotion-css="duxjoh">.css-duxjoh{padding:1rem;margin:0;margin-bottom:2rem;font-size:85%;color:#d6deeb;background-color:#011627;font-family:Consolas,Menlo,Monaco,source-code-pro,Courier New,monospace;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;border-radius:0.5rem;tab-size:4;margin-top:2rem;}.css-duxjoh .changed{color:rgb(162,191,252);font-style:italic;}.css-duxjoh .deleted{color:rgba(239,83,80,0.56);font-style:italic;}.css-duxjoh .inserted,.css-duxjoh .attr-name{color:rgb(173,219,103);font-style:italic;}.css-duxjoh .comment{color:rgb(99,119,119);font-style:italic;}.css-duxjoh .string,.css-duxjoh .url{color:rgb(173,219,103);}.css-duxjoh .variable{color:rgb(214,222,235);}.css-duxjoh .number{color:rgb(247,140,108);}.css-duxjoh .builtin,.css-duxjoh .char,.css-duxjoh .constant,.css-duxjoh .function{color:rgb(130,170,255);}.css-duxjoh .punctuation{color:rgb(199,146,234);}.css-duxjoh .selector,.css-duxjoh .doctype{color:rgb(199,146,234);font-style:italic;}.css-duxjoh .class-name{color:rgb(255,203,139);}.css-duxjoh .tag,.css-duxjoh .operator,.css-duxjoh .keyword{color:rgb(127,219,202);}.css-duxjoh .boolean{color:rgb(255,88,116);}.css-duxjoh .property{color:rgb(128,203,196);}.css-duxjoh .namespace{color:rgb(178,204,214);}</style><style data-emotion-css="12neuit">.css-12neuit{font-size:85%;}</style><pre class="css-duxjoh">template &lt;typename Block&gt;
struct ResNetImpl : torch::nn::Module
 {
    ...
    int64_t groups, base_width, inplanes;
    int64_t _dilation;
    torch::nn::Conv2d conv1;
    torch::nn::BatchNorm bn1;
    torch::nn::Functional max_pool1; 
    /*
        BackBone으로 사용 하기 위해서는 max_pool을 API로 호출 하면
        Segmntation 모델에서 사용 할 수 없기 때문에 Functional 멤버 변수로 선언 해줍니다.
    */
    torch::nn::Linear fc;
    torch::nn::Sequential layer1, layer2, layer3, layer4;
    ...
}

template &lt;typename Block&gt;
torch::Tensor ResNetImpl&lt;Block&gt;::forward(torch::Tensor x) {
    x = conv1-&gt;forward(x);
    x = bn1-&gt;forward(x).relu_();
    /*
    기존 코드 
    x = torch::max_pool2d(x, 3, 2, 1);
    */
    x = max_pool1-&gt;forward(x);

    x = layer1-&gt;forward(x);
    x = layer2-&gt;forward(x);
    x = layer3-&gt;forward(x);
    x = layer4-&gt;forward(x);

    x = torch::adaptive_avg_pool2d(x, { 1, 1 }); //이 아이는 사용 하지 않기 때문에 멤버 함수로 선언 하지 않았어요...
    x = x.view({ x.sizes()[0], -1 });
    x = fc-&gt;forward(x);

    return x;
}
</pre><ul class="css-16v5hhi"><li class="css-n4urzb">IntermediateLayerGetter<br/>Python PyTorch에서는 IntermediateLayer의 경우 모든 Network을 입력 받아 원하는 레이어의 출력만 List에 담아서 리턴을 해주는 클래스인데요.
저 같은 경우에 현재는 resnet만 입력을 받아서 출력을 받는 형태로 되어 있습니다.
여기 저기 물어 봤지만 anyModule 사용해서 하면 된다고 하는데 그렇게 할 경우에 weight값을 복사하기가 불편해 예제의 코드 처럼 구현 했습니다.</li></ul><pre class="css-duxjoh">

/*
생성자에서 Resnet을 입력 받아서 모듈을 OrderedDict 담아 놓고 해당 모듈은 child 모델로 등록 합니다.
사용 방법은 아래와 같아요.

ResNet101 Resnet;   
torch::load(Resnet, &quot;resnet101_Python.pt&quot;);

_backbone = IntermediateLayerGetter(IntermediateLayerGetterImpl(std::move(Resnet), {&quot;layer3&quot;,&quot;layer4&quot;}));
*/
class IntermediateLayerGetterImpl : public torch::nn::Module
{
public:

    template&lt;typename Net&gt;
    IntermediateLayerGetterImpl(Net  Module, std::vector&lt;std::string&gt; return_layers)
    {
        for (auto children : Module-&gt;named_children())
        {
            if (children.key() == &quot;fc&quot;) continue;
        
            _module.insert(children.key(), std::move(children.value()));
            register_module(children.key(), _module[children.key()]);
        }

        _return_layers.swap(return_layers);
    }

    ~IntermediateLayerGetterImpl();

    std::vector&lt;torch::Tensor&gt;  forward(torch::Tensor x);

private:
    torch::OrderedDict&lt;std::string, std::shared_ptr&lt;Module&gt;&gt; _module;
    std::vector&lt;std::string&gt; _return_layers;
};

/*
아래의 forward 때문에 모든 네트웍을 구현 할수가 없었어요. 시간이 없었습니다?
torch::nn::Module을 as 함수를 통해서 Typecasting 지원 하는데요. 넘겨 받은 모델의 Type을 알 수가 없어서 한땀 한땀 변환 해줬습니다.
좋은 방법이 있다면 댓글로 달아 주시면 감사 하겠습니다.
이렇게 사용해도 성능에는 이상이 없습니다.
보기가 아름 답지 않을 뿐이죠....
*/
std::vector&lt;torch::Tensor&gt; IntermediateLayerGetterImpl::forward(torch::Tensor x)
{
    std::vector&lt;torch::Tensor&gt; results;

    x = _module[&quot;conv1&quot;]-&gt;as&lt;torch::nn::Conv2d&gt;()-&gt;forward(x);  
    x = _module[&quot;bn1&quot;]-&gt;as&lt;torch::nn::BatchNorm&gt;()-&gt;forward(x).relu_();
    x = _module[&quot;max_pool1&quot;]-&gt;as&lt;torch::nn::Functional&gt;()-&gt;forward(x);

    x = _module[&quot;layer1&quot;]-&gt;as&lt;torch::nn::Sequential&gt;()-&gt;forward(x);
    x = _module[&quot;layer2&quot;]-&gt;as&lt;torch::nn::Sequential&gt;()-&gt;forward(x);
    x = _module[&quot;layer3&quot;]-&gt;as&lt;torch::nn::Sequential&gt;()-&gt;forward(x);
    results.push_back(x);
    x = _module[&quot;layer4&quot;]-&gt;as&lt;torch::nn::Sequential&gt;()-&gt;forward(x);
    results.push_back(x);
    
    return results;
}

</pre><ul class="css-16v5hhi"><li class="css-n4urzb">SegmentationModel<br/>SegmentationModel은 fcn과 deeplabv3 버전만 구현을 하였습니다. 이 예제를 보고 난후에 여러분은 다른 모델도 만들 자신감이 생기 실 겁니다.
여러분이 직접 구현 할 수 있게 나머지는 남겨 놓았습니다. PullRequest를 보내 주시면 감사 합니다.
멤버 함수로 모델을 선택 할 수 있게 구현 하였습니다.  </li></ul><pre class="css-duxjoh">

/*
    사용 법은 아래와 같아요.
    SegmentationModel segnet;
    segnet-&gt;deeplabv3_resnet101(false, class_num);
    segnet-&gt;to(device);
*/

class SegmentationModelImpl :public torch::nn::Module
{
public:
    SegmentationModelImpl();
    ~SegmentationModelImpl();

public:
    void fcn_resnet101(bool pretrained = false, int64_t num_classes = 21, bool aux = true);
    void fcn_resnet50(bool pretrained = false, int64_t num_classes = 21, bool aux = true);

    void deeplabv3_resnet101(bool pretrained = false, int64_t num_classes = 21, bool aux = true);
    void deeplabv3_resnet50(bool pretrained = false, int64_t num_classes = 21, bool aux = true);

    std::unordered_map&lt;std::string, torch::Tensor&gt; forward(torch::Tensor x);
    IntermediateLayerGetter _backbone{ nullptr };


    torch::nn::Sequential _classifier{ nullptr };
    torch::nn::Sequential _aux_classifier{ nullptr };
    torch::nn::Sequential _make_FCNHead(int64_t in_channels, int64_t channels);
    bool _aux;
};

/*
DeeplabV3 3기준으로 설명을 드릴께요.
*/
void SegmentationModelImpl::deeplabv3_resnet101(bool pretrained, int64_t num_classes, bool aux)
{
    int64_t in_channels = 2048; // resnet의 4번째 레이어의 출력 값이 2048 * 60 * 60 이기때문에 입력은 2048 입니다.

    /*
        _classifier 실제로 Segmentation을 진행 하는 모델 입니다. 
        해당 모델은 논문을 참고 하시는게 도움이 되실꺼에요. 어줍짢은 지식의 전달 보다 사용 법에 집중 할게요.
        코드는 아래와 같이 선언 합니다.
    */
    _classifier = torch::nn::Sequential
    (
        ASPP(ASPPImpl(2048, { 12,24,36 })), 
        torch::nn::Conv2d(
            torch::nn::Conv2dOptions(256, 256, 3).padding(1).with_bias(false)),
        torch::nn::BatchNorm(
            torch::nn::BatchNormOptions(256).eps(0.001).momentum(0.01)),
        torch::nn::Functional(torch::relu),
        torch::nn::Conv2d(
            torch::nn::Conv2dOptions(256, num_classes, 1))
    );

    /*
     aux란 resnet의 3번째 레이어의 출력 값을 Segmentation에 활용 할지 여부인데요. 저같은 경우에는 사용하지 않았습니다.
    */
    
    if (aux != false)
    {
        _aux = aux;
        _aux_classifier = _make_FCNHead(1024, num_classes);
    }

    // 아래는 위에서 설명 드렸네요.
    ResNet101 Resnet;   
    torch::load(Resnet, &quot;resnet101_Python.pt&quot;);

    _backbone = IntermediateLayerGetter(IntermediateLayerGetterImpl(std::move(Resnet), {&quot;layer3&quot;,&quot;layer4&quot;}));

    register_module(&quot;backbone&quot;, _backbone);
    register_module(&quot;classifier&quot;, _classifier);
    register_module(&quot;aux_classifier&quot;, _aux_classifier);
}

/*
 SegmentationModelImpl::forward는 출력인 2개 일 수도 있고 1개 일 수도 있습니다.
 std::unordered_map&lt;std::string, torch::Tensor&gt; 형태로 출력 되고 Key 값을 out과 aux 리턴 합니다.
 
 이미지를 _backbone에 forward 후 출력 값을 _classifier forward 후 출력 된 값을 
 이미지 사이즈 만큼 다시 upsample 하여 출력 합니다. aux를 사용 할 경우에 _aux_classifier 출력 값도 리턴 합니다.

*/
std::unordered_map&lt;std::string, torch::Tensor&gt; SegmentationModelImpl::forward(torch::Tensor x)
{
    std::unordered_map&lt;std::string, torch::Tensor&gt; result;

    int64_t h = x.size(2), w = x.size(3);

    auto feature = _backbone-&gt;forward(x);

    x = feature[1];

    x = _classifier-&gt;forward(x);
    x = torch::upsample_bilinear2d(x, { h,w }, false);
    result.insert(std::make_pair(&quot;out&quot;, x));

    if (_aux == true)
    {
        x = feature[0];
        x = _aux_classifier-&gt;forward(x);
        x = torch::upsample_bilinear2d(x, { h,w }, false);
        result.insert(std::make_pair(&quot;aux&quot;, x));
    }

    return result;
}  

</pre><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h1 id="convert-python-model-parameter-to-c" class="css-1ub9cvv css-og3soz"><a href="#convert-python-model-parameter-to-c" class="css-10kjd3a">Convert Python Model Parameter to C++<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h1><p class="css-1jg7uzx">Convert Python Model <a href="https://kerry-cho.github.io/TransferLearning-Libtorch/" class="css-wa7nh6">TransferLearning</a> 포스트를 참고 하시면 됩니다.</p><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h1 id="dataset" class="css-1ub9cvv css-og3soz"><a href="#dataset" class="css-10kjd3a">DataSet<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h1><p class="css-1jg7uzx">데이터 셋은 MS COCO 데이터 셋을 사용 하였습니다.
데이터 셋은 클래스는 메인 객체와 2개의 하위 객체를 포함 하고 있습니다. 시각화를 위해 UML을 그려 보았습니다.
COCODataSet 클래스에서 멤버 클래스로 CocoDetection 클래스를 가지고  CocoDetection에서 CocoData셋의 JSON Parser인 CocoNote를 포함 하고 있습니다.</p><p class="css-1jg7uzx"><span class="gatsby-resp-image-wrapper" style="position:relative;display:block;margin-left:auto;margin-right:auto;max-width:872px">
      <span class="gatsby-resp-image-background-image" style="padding-bottom:34.03508771929824%;position:relative;bottom:0;left:0;background-image:url(&#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABB0lEQVQY002QbYuFIBCF+/8/L25FhBJ1syJfUvOqqONlk93t+TAwh3PmwFSMsa7rmqbp+14IoZQCAMbYMAyv16tt22mapJTee6XUuq7FqZRijFXTNPU327ZZa8/zBABCyDiOnHMhhDFGSmmtJYRgjOu6nufZe7+uazUMw/v9zjkDQIxRa51zxhgTQlJK4eY8T+89QqjrulIbQtj3vUIIGWOcc9ZaY8xxHM45jPGyLDHGEAIAcM6llMuyIITGcQwh5JwppRWlFADyTUqpXL2uq4hlaq2NMZ/PJ6UUYyziTzg/SCmVmLX2qV/X5W7K+h/WWqtfhBDlYZRS9YBz7r1njP2Ztdbbtn0BzTCK5+GpMbYAAAAASUVORK5CYII=&#x27;);background-size:cover;display:block"></span>
  <style data-emotion-css="1nh7vc8">.css-1nh7vc8{padding:0;margin:0;margin-bottom:1rem;max-width:100%;padding:0;margin:0;margin-bottom:1rem;max-width:100%;}</style><img class="gatsby-resp-image-image css-1nh7vc8" alt="dataset" title="dataset" src="/static/0ab5fe90c2d7995c9a8bed564a2aff7d/bdb44/dataset.png" srcSet="/static/0ab5fe90c2d7995c9a8bed564a2aff7d/050f2/dataset.png 285w,/static/0ab5fe90c2d7995c9a8bed564a2aff7d/2b0be/dataset.png 570w,/static/0ab5fe90c2d7995c9a8bed564a2aff7d/bdb44/dataset.png 872w" sizes="(max-width: 872px) 100vw, 872px" style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0" loading="lazy"/>
    </span></p><p class="css-1jg7uzx">COCODataSet 구조  </p><pre class="css-duxjoh">/*
COCODataSet은 객체 생성시 4개의 입력을 받습니다.
annFile  = annotation File의 전체 경로
root     = 이미지 파일이 있는 경로 ,annotation에는 이미지 파일 명만 표시 되어 있습니다.
cat_list = 학습 시키길 원하는 카테고리 정보 0은 Background 이며 , 숫자로 입력됩니다
           해당 숫자는 MS COCO 2017 카테고리 정보를 참고 하세요.
remove_images_without_annotations = 주석이 없는 이미지의 삭제 여부

Example
auto val_dataset = COCODataSet(data_dir + &quot;annotations\\instances_val2017.json&quot;, data_dir + &quot;val2017&quot;, true, { 0,17,18 })
    .map(torch::data::transforms::Stack&lt;&gt;());
const size_t va_dataset_size = val_dataset.size().value();

*/


class COCODataSet : public torch::data::Dataset&lt;COCODataSet&gt;
{
private:

    std::vector&lt;torch::Tensor&gt; states, labels;
    size_t ds_size;
    torch::data::transforms::Normalize&lt;&gt; normalizeChannels;
public:
    COCODataSet(std::string annFile, std::string root, bool remove_images_without_annotations 
        , std::vector&lt;int&gt; cat_list = std::vector&lt;int&gt;{});

    torch::data::Example&lt;&gt; get(size_t index) override;
    torch::optional&lt;size_t&gt; size() const override;

    rcnn::data::COCODetection _coco_detection;
    std::vector&lt;int&gt; _cat_list;
    std::map&lt;int, int&gt; _cat_idx;
};
// 하위 객체 설명 후에 더 자세히 설명 하겠습니다.
</pre><p class="css-1jg7uzx">COCODetection</p><pre class="css-duxjoh">

/*
COCODetection 의 경우 생성시 2개의 입력을 받습니다.
annFile  = annotation File의 전체 경로
root     = 이미지 파일이 있는 경로 ,annotation에는 이미지 파일 명만 표시 되어 있습니다.
*/
namespace rcnn {
namespace data 
{

class COCODetection : public torch::data::datasets::Dataset&lt;COCODetection, torch::data::Example&lt;cv::Mat, std::vector&lt;Annotation&gt;&gt;&gt; 
{

public:
    COCODetection(std::string root, std::string annFile/*TODO transform=*/);
    torch::data::Example&lt;cv::Mat, std::vector&lt;Annotation&gt;&gt; get(size_t index) override;
    torch::optional&lt;size_t&gt; size() const override;

    std::string _root;
    COCONote _coco;
    std::vector&lt;int&gt; _ids;

    friend std::ostream&amp; operator &lt;&lt; (std::ostream&amp; os, const COCODetection&amp; bml);
};

}//data
}//rcnn

/*
이미지파일의 인덱스 정보를 가져와 해당 이미지의 Annotation 정보와 이미지파일을 로딩 하여 반환 합니다.
*/
torch::data::Example&lt;cv::Mat, std::vector&lt;Annotation&gt;&gt; COCODetection::get(size_t index) 
{
    int img_id = _ids.at(index);
    std::vector&lt;int64_t&gt; ann_ids = _coco.GetAnnIds(std::vector&lt;int&gt;{img_id}); //Image ID
    std::vector&lt;Annotation&gt; target = _coco.LoadAnns(ann_ids); // Load Anotations
    std::string path(_coco.LoadImgs(std::vector&lt;int&gt;{img_id})[0]._file_name); //LoadImage
    cv::Mat img = cv::imread(_root + &quot;/&quot; + path, cv::IMREAD_COLOR);

    if (img.rows == 0)
    {
        std::cout &lt;&lt; &quot;The image does not exist.&quot; &lt;&lt; std::endl;
        std::cout &lt;&lt; _root + &quot;/&quot; + path &lt;&lt; std::endl;
        quick_exit(1);
    }


    torch::data::Example&lt;cv::Mat, std::vector&lt;Annotation&gt;&gt; value{ img, target };
    return value;
}

/*
전체 데이터 사이즈를 반환
*/
torch::optional&lt;size_t&gt; COCODetection::size() const
{
    return _ids.size();
}
</pre><p class="css-1jg7uzx">COCONote</p><pre class="css-duxjoh">

/*
Poco::JSON의 JSON을 사용해 annotation 정보를 읽어 드리는 클래스 입니다.
Poco는 해당 프로젝트를 위해 직접 빌드 하여 사용 하였습니다.
기회가 된다면 자세히 리뷰를 하는 포스팅을 진행 하겠습니다.
*/
struct COCONote
{
    COCONote(std::string annotation_file);
    COCONote();

    void Parse();
    void Parse(std::string annotation_file);

    std::vector&lt;int64_t&gt; GetAnnIds(const std::vector&lt;int&gt; imgIds = std::vector&lt;int&gt;{}, const std::vector&lt;int&gt; catIds = std::vector&lt;int&gt;{}, const std::vector&lt;float&gt; areaRng = 
...
};

/*
직접 Parsing을 진행 하는 함수 입니다.
*/
void COCONote::Parse()
{
#ifdef _DEBUG
    std::cout &lt;&lt; &quot;Parse...\n&quot;;
#endif
    if(_cocodataset-&gt;has(&quot;annotations&quot;))//annotations 정보가 있는지 확인 합니다.
    {
        assert(_cocodataset-&gt;get(&quot;annotations&quot;).isArray()); //annotations이 Array객체가 아닐 경우 예외를 발생 시킵니다.

        Array::Ptr a = _cocodataset-&gt;get(&quot;annotations&quot;).extract&lt;Array::Ptr&gt;(); //annotations 을 ArryPtr 타입으로 변환 합니다.

        for(int i = 0; i &lt; a-&gt;size(); i++)//Array Size 만큼 for를 진행 합니다.
        {
            Object::Ptr j = a-&gt;get(i).extract&lt;Object::Ptr&gt;(); //각 인덱스 별로 Object::Ptr변환 합니다.

            if(_imgToAnns.count(j-&gt;get(&quot;image_id&quot;).convert&lt;int&gt;()))//이미지의 id를 가져와 _imgToAnns에 있는지 비교합니다.
            { // if it exists
                _imgToAnns[j-&gt;get(&quot;image_id&quot;).convert&lt;int&gt;()].emplace_back(j);// 존재 할경우에 해당 Key값에 집어 넣습니다.
            }
            else
            {
                _imgToAnns[j-&gt;get(&quot;image_id&quot;).convert&lt;int&gt;()] = std::vector&lt;Annotation&gt; {Annotation(j)};// 없을 경우에는 새로운 Annotation만들어 _imgToAnns에 담습니다.
            }
            
            _anns[static_cast&lt;int64_t&gt;(j-&gt;get(&quot;id&quot;).convert&lt;int64_t&gt;())] = Annotation(j);
        }
    }

    ....
}
</pre><ul class="css-16v5hhi"><li class="css-n4urzb">Data Arguments<br/>이미지와 Annotation 정보는 COCODataSet Get 함수가 호출 될시에 진행 됩니다.</li></ul><pre class="css-duxjoh">

/*
함수가 상당히 길지만 상세하게 설명 하고 주의 깊게 보는게 좋을 것 같습니다.
*/
torch::data::Example&lt;&gt; COCODataSet::get(size_t idx)
{
    auto coco_data = _coco_detection.get(idx);
    cv::Mat img = coco_data.data;
    
    //현재 idx Annotation 정보를 가져와 내가 학습 하고자 하는 카테고리를 제외한 정보는 삭제 합니다.

    std::vector&lt;Annotation&gt; anno = coco_data.target;
    for (auto ann = anno.begin(); ann != anno.end();) 
    {
        if (std::find(_cat_list.begin(), _cat_list.end(), ann-&gt;_category_id) == _cat_list.end())
        {
            anno.erase(ann);
        }
        else
        {
            ann++;
        }
    }

    //Annotation 정보는 Polygon 형태의 자료형으로 되어 있습니다. 해당 정보를 
    // H * W 형태의 Matrix 타입의 구조로 타입 변환을 진행 하는 함수 입니다.
    // Matrix 정보에서 해당 카테고리 영역은 값이 1이고 , 나머지는 0의 값이 채워 집니다.
    // COCO DataSet의 Polygon 정보는  x1,y1,x2,y2,x3,y3,xn,yn의 형태로 double Array 타입으로 되어 있습니다.
    std::vector&lt;int&gt; cats;
    std::vector&lt;std::vector&lt;std::vector&lt;double&gt;&gt;&gt; polys;
    for (auto&amp; obj : anno)
    {
        polys.push_back(obj._segmentation);//Annotation _segmentation정보만 가져 옵니다. PolyLines
        cats.push_back(_cat_idx[obj._category_id]);//위 Polygon의 Category ID에 해당 하는 인덱스를 가져 옵니다.
    //예제에서는 Category list가 {0 , 17 ,18} 로 입력 되었습니다.
    //예를 들어 고양이 일 경우 Category ID가 17이기 때문에 index는 1이 입력 됩니다.
    }

    std::vector&lt;torch::Tensor&gt;  mask_tensors;

    //이미지와 마스크의 입력 사이즈는 480으로 변경 하기위한 Base Size 입니다.
    int base_size = 480;

    //Polygon To Mask Tensors
    for (int k= 0; k&lt; polys.size(); k++)
    {
        //Polygon의 사이즈가 0 일 경우 리턴 합니다.
        if (polys[k].size() == 0) continue;
        
        //현재 로딩 된 이미지와 Base사이지를 비교해 scale 값을 구한 후 Polygon을 Resize 해줍니다.     
        transforms::polygon::Resize((double)base_size / (double)img.cols, (double)base_size / (double)img.rows, polys[k]);


        //coco API를 사용 하기위해서 Polygon 정보를 coco API 에서 사용하는 자료 형으로 변환 후 
        //Mask 정보를 리턴 받습니다.
        auto frPoly = coco::frPoly(polys[k], base_size, base_size);

        coco::RLEs Rs(1);

        coco::rleFrString(Rs._R, (char*)frPoly[0].counts.c_str(), std::get&lt;0&gt;(frPoly[0].size), std::get&lt;1&gt;(frPoly[0].size));
        coco::siz h = Rs._R[0].h, w = Rs._R[0].w, n = Rs._n;
        coco::Masks masks = coco::Masks(base_size, base_size, 1);

        coco::rleDecode(Rs._R, masks._mask, n);

        //coco API 변환한 Mask Size 만큼 비어 있는 Tensor 생성 합니다.
        int shape = h * w * n;
        torch::Tensor mask_tensor = torch::empty({ shape });

        float* data1 = mask_tensor.data_ptr&lt;float&gt;(); //해당 Tensor를 Dataptr 변경 후에 
        for (size_t i = 0; i &lt; shape; ++i) {
            data1[i] = static_cast&lt;float&gt;(masks._mask[i] * cats[k]);//Category Index를 곱한 후 값을 복사 해 줍니다.
        }

        //Mask는 해당 Category 영역은 1, 아닐 경우 0 이기 때문에 Category ID 곱하면 개 일 경우 2로 변경 되고
        //아닌 영역은 0으로 채워 집니다.

        //Mask_tensor를 Category에 Mapping 후에 이미지 사이와 동일한 Matrix 형태로 변경 합니다
        // h * w 
        mask_tensor = mask_tensor.reshape({ static_cast&lt;int64_t&gt;(n),static_cast&lt;int64_t&gt;(w),
            static_cast&lt;int64_t&gt;(h) }).permute({ 2, 1, 0 }).squeeze(2);//fortran order h, w, n

        mask_tensors.push_back(mask_tensor);
    }
    
    // mask_tensors는 Vector를 Tensor Type로 변경 합니다.
    // n * h * w 형태로 변환 됩니다.
    auto mask_tensor = torch::stack(mask_tensors); 

    //n * h * w 형태의 Tensor를 하나로 합치게 됩니다.
    //예 4 * h * w -&gt; h * w;
    // 동일한 영역의 값을 취하는 게 아니라 Max 값만 가져 옵니다.
    // 즉 서로 다른 카테고리 마스크를 하나로 합칩니다.
    torch::Tensor target, _;
    std::tie(target, _) = torch::max(mask_tensor, 0);
    
    //현재 로딩 된 이미지를 Resizng 합니다.
    cv::resize(img, img, cv::Size(base_size, base_size));


    //Random 값이 2의 배수일 경우 이미지와 target을 Horizental Flip을 진행 합니다.
    if (die(mersenne) % 2 == 0)
    {
        target = target.flip({ 1 });
        cv::flip(img, img, 1);
    }

    torch::Tensor img_tensor = torch::from_blob(img.data, { img.rows, img.cols, 3 }, torch::kByte);
    img_tensor = img_tensor.permute({ 2, 0, 1 });

    //이미지를 normalize 합니다.
    img_tensor = normalizeChannels(img_tensor);

    // 아래 코드는 이미와 Tensor가 제대로 입력이 되는지 확인 하기 위한 Debug  코드 입니다.
#if 0 // Debug Data Inputs
    std::cout &lt;&lt; img_tensor.sizes() &lt;&lt; std::endl;
    std::cout &lt;&lt; target.sizes() &lt;&lt; std::endl;

    cv::Mat bin_mask = cv::Mat::eye(target.size(0), target.size(1), CV_8UC1);
    target = target.clamp(0, 255).to(torch::kU8);
    target = target.to(torch::kCPU);
    std::memcpy(bin_mask.data, target.data_ptr(), sizeof(torch::kU8) * target.numel());

    uchar* data_ptr = (uchar*)bin_mask.data;

    for (int y = 0; y &lt; bin_mask.rows; y++)
    {
        for (int x = 0; x &lt; bin_mask.cols; x++)
        {
            if (data_ptr[y * bin_mask.cols + x] == 0)
            {
                continue;
            }
            else
            {
                data_ptr[y * bin_mask.cols + x]  = 255;
            }
        }
    }

    cv::imshow(&quot;Image&quot;, bin_mask);
    cv::imshow(&quot;Image2&quot;, img);
    cv::waitKey(0);
#endif

    //Image와 Tensor를 Tuple 형태로 반환 합니다.
    return { img_tensor.clone(), target.clone() };
}
</pre><ul class="css-16v5hhi"><li class="css-n4urzb">Data Loader  &amp; Opimizer  </li></ul><p class="css-1jg7uzx">Data Loader Opimizer의 상세한 정보는 <a href="https://kerry-cho.github.io/TransferLearning-Libtorch/" class="css-wa7nh6">TransferLearning</a> 포스트를 참고 하시면 됩니다.
다른 점만 설명 하겠습니다.  </p><p class="css-1jg7uzx">Segmentation에서는 Backbone이 존재하고 해당 모델의 경우 Aux 라는 옵션이 있기 때문에 그에 따라 Optimizer에서 학습 해야 하는<br/>
<!-- -->학습 파라메터가 조금 씩 다릅니다.</p><pre class="css-duxjoh">

/*
TransferLearning 크게 다른 점은 Backbone 파라메터와 _classifier의 파라메터 
aux_classifier파라메터를 각각 std::vector&lt;torch::Tensor&gt; 담아 주어야 한다는 점입니다.
해당 예제는 aux_classifier를 사용 하지 않기 때문에 생략 하였습니다.
*/
std::vector&lt;torch::Tensor&gt; trainable_params;    
auto params = segnet-&gt;_classifier-&gt;named_parameters(true /*recurse*/);
for (auto&amp; param : params)
{
    auto layer_name = param.key();

    if (param.value().requires_grad())
    {
        trainable_params.push_back(param.value());
    }
}

params = segnet-&gt;_backbone-&gt;named_parameters(true /*recurse*/);
for (auto&amp; param : params)
{
    if (param.value().requires_grad())
    {
        trainable_params.push_back(param.value());
    }
}

torch::optim::SGD optimizer(trainable_params, torch::optim::SGDOptions(0.01 /*learning rate*/).momentum(0.9).weight_decay(1e-4));
</pre><ul class="css-16v5hhi"><li class="css-n4urzb">Training Loop &amp; test Loop</li></ul><p class="css-1jg7uzx">학습과 테스트는 TransferLearning 크게 다르지 않습니다. 따라서 Loss를 구하는 함수에 대해서만 설명 드리고 나머지 부분은
<a href="https://kerry-cho.github.io/TransferLearning-Libtorch/" class="css-wa7nh6">TransferLearning</a> 포스트를 참고 하시면 됩니다.</p><p class="css-1jg7uzx">loss함수</p><pre class="css-duxjoh">

/*
loss 함수는 Classcification처럼 CrossEntropy를 구하는데요. Segmentation의 경우 Pixel 전체를 비교 한다고 생각 하시면 됩니다.
해당 함수는 LibTorch에 존재 하지 않아서 Network 출력 값을 log_softmax 취한 후 nll_loss2d 함수로 계산 합니다.
*/
torch::Tensor criterion(
    std::unordered_map&lt;std::string, torch::Tensor&gt; inputs, torch::Tensor target)
{
    std::map&lt;std::string, torch::Tensor&gt; losses;

    for (auto loss : inputs)
    {
        losses[loss.first] = torch::nll_loss2d(torch::log_softmax(loss.second, 1), target, {}, 1, 255);
    }

    if (losses.size() == 1)
    {
        return losses[&quot;out&quot;];
    }

    return losses[&quot;out&quot;] + 0.5 * losses[&quot;aux&quot;];
}
</pre><style data-emotion-css="1700n7b">.css-1700n7b{padding:0;margin:0;margin-bottom:1rem;font-size:1.5rem;font-family:'Inter',sans-serif;line-height:1.33;font-weight:bold;display:block;color:var(--theme-ui-colors-heading,#2d3748);-webkit-text-decoration:none;text-decoration:none;}</style><style data-emotion="css og3soz">.css-og3soz{pointer-events:painted;}.css-og3soz svg{visibility:hidden;width:icon.xs;height:icon.xs;position:absolute;top:50%;-webkit-transform:translate(0,-50%);-moz-transform:translate(0,-50%);-ms-transform:translate(0,-50%);transform:translate(0,-50%);padding-left:8px;}.css-og3soz:hover svg{visibility:visible;}</style><h2 id="conclusion" class="css-1700n7b css-og3soz"><style data-emotion-css="1qh5hbx">.css-1qh5hbx{box-sizing:border-box;margin:0;min-width:0;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1.5rem;position:relative;}</style><a href="#conclusion" class="css-1qh5hbx">Conclusion<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a></h2><p class="css-1jg7uzx">지금까지 LibTorch를 이용한 Segmentation 대해서 이야기를 하였습니다. 여기 까지 읽어 주신것을 감사 드립니다.
Segmentation에 대해 이론적으로 접근 하기 보다 LibTorch를 활용 한 방법에 대해서 설명을 집중 하였습니다. 포스팅 초반에 Segmentation이라는
사전지식이 필요 하다고 했는데 실제 해당 내용에 대한 설명은 진행 하지 않은 것 같네요. 하지만 Segmentation이 무엇을 하는 것이란 걸
알고 해당 포스트를 읽는 것이 중요 하다고 생각하였습니다.
궁금 한 내용이나, 잘못 된 점이 있다면 답글에 남겨 주시면 감사 하겠습니다.
다음 이야기는 Microsoft에서 진행 하는 OpenSource 프로젝트중 VoTT에 대한 리뷰를 진행 하겠습니다(Visual Object Tagging Tool)
감사합니다.</p><div class="css-vurnku"><style data-emotion-css="3fn5ou">.css-3fn5ou{box-sizing:border-box;margin:0;min-width:0;color:gray;margin:0;margin-top:0.5rem;margin-bottom:0.5rem;border:0;border-bottom:1px solid;padding:0;margin:0;margin-bottom:2rem;border:0;border-bottom:1px solid;margin-top:2rem;color:var(--theme-ui-colors-omegaLight,#e2e8f0);}</style><hr class="css-3fn5ou"/><style data-emotion-css="1y5vlh1">.css-1y5vlh1{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:640px){.css-1y5vlh1{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}.css-1y5vlh1 > div + div{margin-top:1rem;-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}@media screen and (min-width:640px){.css-1y5vlh1 > div + div{margin-top:0;}}</style><div class="css-1y5vlh1"><style data-emotion-css="zkfaav">.css-zkfaav{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-zkfaav"><style data-emotion-css="wzwz2y">.css-wzwz2y{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:0.875rem;color:var(--theme-ui-colors-omegaDark,#718096);margin-right:1rem;margin-bottom:0;}</style><h2 class="css-wzwz2y">Tags</h2><style data-emotion-css="1sine8z">.css-1sine8z{box-sizing:border-box;margin:0;min-width:0;}.css-1sine8z a{margin-bottom:0.25rem;margin-right:0.25rem;}</style><div class="css-1sine8z"><style data-emotion-css="1aepyww">.css-1aepyww{box-sizing:border-box;margin:0;min-width:0;display:inline-block;vertical-align:baseline;font-size:0.75rem;font-weight:700;white-space:nowrap;padding-left:0.25rem;padding-right:0.25rem;border-radius:2px;color:var(--theme-ui-colors-white,#fff);background-color:primary;display:inline-block;border-radius:0.5rem;-webkit-text-decoration:none;text-decoration:none;font-weight:600;vertical-align:middle;padding-left:1rem;padding-right:1rem;padding-top:0.25rem;padding-bottom:0.25rem;-webkit-transition:all 250ms ease;transition:all 250ms ease;background-color:var(--theme-ui-colors-omegaLight,#e2e8f0);color:var(--theme-ui-colors-omegaDark,#718096);}.css-1aepyww:hover{color:var(--theme-ui-colors-omegaLight,#e2e8f0);background-color:var(--theme-ui-colors-omegaDark,#718096);}</style><a class="css-1aepyww" href="/tag/libtorch/">#Libtorch</a><a class="css-1aepyww" href="/tag/pytorh/">#Pytorh</a></div></div></div></div><style data-emotion-css="147c3tb">.css-147c3tb{box-sizing:border-box;margin:0;min-width:0;background-color:var(--theme-ui-colors-omegaLight,#e2e8f0);border-radius:0 0 0.5rem 0.5rem;color:var(--theme-ui-colors-omegaDark,#718096);border-style:solid;border-width:3px;border-color:var(--theme-ui-colors-contentBg,#fff);margin-left:-2rem;margin-right:-2rem;margin-bottom:-2rem;margin-top:2rem;}</style><div class="css-147c3tb"><style data-emotion-css="8hkjl7">.css-8hkjl7{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:2rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-8hkjl7"><style data-emotion-css="onilhx">.css-onilhx{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;}</style><div class="css-onilhx"><style data-emotion-css="1uk98e1">.css-1uk98e1{box-sizing:border-box;margin:0;min-width:0;margin-bottom:0.5rem;}</style><div class="css-1uk98e1">Previous Article</div><style data-emotion-css="1u56ygl">.css-1u56ygl{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1rem;}</style><a class="css-1u56ygl" href="/transferlearning-libtorch/">TransferLearning Libtorch</a></div><style data-emotion-css="wn4zyw">.css-wn4zyw{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:50%;-ms-flex-preferred-size:50%;flex-basis:50%;text-align:right;}</style><div class="css-wn4zyw"><div class="css-1uk98e1">Next Article</div><a class="css-1u56ygl" href="/custom-git-bash/">Custom Git Bash</a></div></div></div></div></div><style data-emotion-css="18gvkve">.css-18gvkve{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;display:none;-webkit-flex-basis:33.333333%;-ms-flex-preferred-size:33.333333%;flex-basis:33.333333%;padding-left:4rem;margin-right:0;}@media screen and (min-width:768px){.css-18gvkve{display:block;}}</style><div class="css-18gvkve"><div class="css-4p9r15"><div class="css-1yus8ce"><style data-emotion-css="1lx7oj">.css-1lx7oj{box-sizing:border-box;margin:0;min-width:0;text-align:center;}</style><div class="css-1lx7oj"><style data-emotion-css="193v69v">.css-193v69v{box-sizing:border-box;margin:0;min-width:0;margin-bottom:2rem;}</style><div class="css-193v69v"><style data-emotion-css="q8lpjg">.css-q8lpjg{box-sizing:border-box;margin:0;min-width:0;color:var(--theme-ui-colors-alpha,#667eea);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;}.css-q8lpjg:visited{color:var(--theme-ui-colors-alpha,#667eea);}.css-q8lpjg:hover{color:var(--theme-ui-colors-alphaDark,#5a67d8);}</style><a aria-label="Kerry Cho" class="css-q8lpjg" href="/author/kerry-cho/"><style data-emotion-css="652wqb">.css-652wqb{box-sizing:border-box;margin:0;min-width:0;position:relative;z-index:2;text-align:center;margin-bottom:1.0499999999999998rem;}</style><div class="css-652wqb"><div class="css-vurnku"><style data-emotion="css dkmdyt">.css-dkmdyt{margin-left:auto;margin-right:auto;}.css-dkmdyt img{border-radius:0 0 9999px 9999px;}</style><div data-gatsby-image-wrapper="" style="width:150px;height:150px" class="gatsby-image-wrapper css-dkmdyt"><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/svg+xml,%3csvg%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20width=&#x27;320&#x27;%20height=&#x27;320&#x27;%20viewBox=&#x27;0%200%20320%20320&#x27;%20preserveAspectRatio=&#x27;none&#x27;%3e%3cpath%20d=&#x27;M137%209c-12%204-18%208-26%2019-6%209-7%2012-8%2025l-1%2011v3l5%2018c0%206%205%2021%2010%2031%204%208%204%208-3%2010-6%202-7%203-13%2011l-1%202-11%209c-7%204-7%204-9%200l-1-2v2c1%202%200%204-1%204l-1%204-2%205c-2%201-2%201-2-3v-4l-1-1-1%206c0%2011%200%2012-2%2013-2%202-1%203%201%202v6c0%206-2%206-4%200-7-14-12-8-7%206%204%2012%204%2016%201%2017l-1%202-1%201-1%203-3%206c-3%204-2%205%200%206s2%201-1%201c-3%201-4%202-5%204l-1%2011%201%203%203%202%201%201v1c2%200%201%204-1%205v2c2%201%201%202-1%202-3-1-6%202-6%206s2%208%204%208v2l-2%204c0%202%201%202%206-3l3-3%204%202c4%202%204%203%202%203-5%200-14%203-16%205-2%203-1%204%202%202%207-4%2018-4%2018-1l1%202%202%204c1%204%200%207-2%208l-3%204c-1%201-1%202-3%201-1%200-2%200-5%203l-7%204c-2%200-2%201%204%204%204%202%209%205%2011%208l4%204h119l-6-7c-7-8-8-10-1-9%202%200%205-4%206-6s7%204%207%206l-2%202c-3%200-7%2011-4%2011l1%202%2026%201h26l2-3%204-6c3-3%204-7%202-11-1-3-1-4%201-7l5-15-2-1c-1%201-5%200-9-1l-8-1%203%205c7%2010%2010%2018%204%2011-5-7-11-13-12-12l-1-1c-1-2-8-6-11-6l-1-2c1-5%200-5-10-2h-13l1-1%2016-6c0-3-5-3-11-1l-7%201%203-7c4-8%206-15%204-14l-5%207c-5%208-7%2010-7%208h-1c-3%202-5-3-2-5h2c1%202%202%201%202-3v-5l1-1c0-2-1-2-3-1-2%202-5-1-3-3v-4h-8l-1%201v2c1%201%201%201-1%202-2%202-4%201-4-3%200-2-3-5-4-4-2%201-4-2-3-4v-1c-3%201-3-1-1-3l2-2a62%2062%200%20001%204l2%202c2%201%202%201%202-1-1-3%203-5%205-2l2%202%206%202c6%203%208%202%205-1l-3-5c0-2-4-6-6-5-2%200-2-3-1-6l6-6%205-6%201-2c1%200%202-1%201-2l1-1v-11l1-1-2-2v-1c2-1%202-6%200-12%200-2%200-2-1-1-2%204-6%201-6-5%204-34%204-33-4-38-5-4-6-4-6-7%200-5%204-15%206-16%203%200%205-4%205-9l2-12c6-31%206-37%201-46-7-16-33-28-49-24m-5%2066l-2%206-3%204c-2%202-1%203%202%202l7%201c6%202%207%202%204-1l-3-8c-1-6-3-7-5-4m-14%2069c-2%202-6%203-12%204-5%200-6%201-7%203l-4%207c-2%205-3%207%200%209%202%202%201%203-2%204-4%201-2%202%205%202l8%201c4%202%207%202%2010%200s13-2%2018%201c3%202%205%206%205%2010-1%202-12%205-16%203-6-3-2-6%207-5%204%201%205%200%202-3-2-2-6-3-10%200l-7%201-5%201h-1l-1%201c-1%201-1%201-3-1-4-5-13-4-13%201l5%201%207%201c1%202-3%204-6%204h-2l2%201%203%201h-3c-4%201-8%200-4-1%201-1%201-1-1-1-3-1-7%200-7%202%200%2010%205%2018%2012%2020s27%201%2034-2c5-2%206-3%2010-10%204-8%205-15%203-16l-1-3-1-2c-1%200-3-6-4-13s-2-10-5-9l-2-2-5-5-1-1-2-2-2-1c-1-2-2-2-4-1m108%2022a65%2065%200%2000-11%2020l-3%207-1%202-1%203-2%202v2l-1%202c-2%200-2%201-2%203l-2%204-2%205-2%204-2%204v6l-2%201h-4l-2-1c-2%201%206%205%209%205%202-1%204%201%207%207l3%205%203%208%203%208%207%203%2011%203c4%200%208%202%205%202s5%203%208%203a1182%201182%200%200111-11c1-2%200-2-6-1-4%201-5%200-7-1-3-3-10-5-20-5-9%200-11-2-8-5v-4c-2-1-2-1%200-2l3-1%202-1c4%200%2013-6%2016-10l3-3%201-1%204-6c7-7%2010-15%206-13-2%200-2%200-1-5%202-5%203-13%202-13l-2%202-2%201a251%20251%200%2000-35%2016c-2-1%202-8%208-14l7-8%202-4v-2c-1-1-3%200-10%209-6%206-5%203%204-14l7-15-4%203m12%2037c-6%204-9%207-9%2010-1%203-9%2014-12%2016l-5%203c-4%202-5%204-3%203%202%200%203%202%202%206-1%203%200%204%201%204l1-1v-2l2-4%203-3%202-2%208-9%208-9%204-5%203-5%202-2c4-4-1-4-7%200m9%2036c-4%2010-4%2010-2%2010v1c-2%200-2%201-1%201v3c0%202%201%201%204-1%204-4%205-7%205-12-2-9-2-9-6-2m-36%2039l2%204c3%207%203%2013-1%2018l-2%205c0%203%200%203%203%203h6l5%201c1-1-2-6-4-7-3%200-2-2%201-4h8c7%202%2010%202%2012%201%201-1%201-2-2-2-3-1-7-4-12-11l-4-5-12-3m-8%204c-2%202-7%202-10%201-3-2-4%200-2%203l6%209c4%208%205%207%202%200s-3-6%202-6%2010-5%207-7h-5&#x27;%20fill=&#x27;%23d3d3d3&#x27;%20fill-rule=&#x27;evenodd&#x27;/%3e%3c/svg%3e" alt=""/><picture><source type="image/webp" data-srcset="/static/852c30a1756768fa576889f312b2bd64/ae23d/kerry-cho.webp 150w,/static/852c30a1756768fa576889f312b2bd64/bd37b/kerry-cho.webp 300w" sizes="150px"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="150px" decoding="async" loading="lazy" data-src="/static/852c30a1756768fa576889f312b2bd64/46e60/kerry-cho.png" data-srcset="/static/852c30a1756768fa576889f312b2bd64/46e60/kerry-cho.png 150w,/static/852c30a1756768fa576889f312b2bd64/d612b/kerry-cho.png 300w" alt="Kerry Cho"/></picture><noscript><picture><source type="image/webp" srcSet="/static/852c30a1756768fa576889f312b2bd64/ae23d/kerry-cho.webp 150w,/static/852c30a1756768fa576889f312b2bd64/bd37b/kerry-cho.webp 300w" sizes="150px"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="150px" decoding="async" loading="lazy" src="/static/852c30a1756768fa576889f312b2bd64/46e60/kerry-cho.png" srcSet="/static/852c30a1756768fa576889f312b2bd64/46e60/kerry-cho.png 150w,/static/852c30a1756768fa576889f312b2bd64/d612b/kerry-cho.png 300w" alt="Kerry Cho"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></div></div></a></div><a class="css-q8lpjg" href="/author/kerry-cho/"><style data-emotion-css="19jxby7">.css-19jxby7{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1.25rem;}</style><h2 class="css-19jxby7">Kerry Cho</h2></a><style data-emotion-css="vboy0k">.css-vboy0k{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1rem;color:var(--theme-ui-colors-omegaDark,#718096);}</style><h2 class="css-vboy0k">Software Engineer</h2><style data-emotion-css="xqiep1">.css-xqiep1{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-xqiep1"><style data-emotion-css="1h78vxn">.css-1h78vxn{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;padding:0.25rem;width:32px;height:32px;color:inherit;background-color:transparent;border:none;border-radius:4px;display:inline-block;min-width:auto;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:space-evenly;-webkit-justify-content:space-evenly;-ms-flex-pack:space-evenly;justify-content:space-evenly;outline:0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;border-radius:9999px;cursor:pointer;border-width:3px;border-style:solid;-webkit-transition:all 250ms ease;transition:all 250ms ease;box-sizing:initial;color:var(--theme-ui-colors-omega,#a0aec0);border-color:transparent;vertical-align:middle;width:24px;height:24px;padding:0.5rem;background-color:var(--theme-ui-colors-omegaLighter,#edf2f7);}.css-1h78vxn +a,.css-1h78vxn + button{margin-left:0.5rem;}.css-1h78vxn svg{width:24px;height:24px;}@media (hover:hover) and (pointer:fine){.css-1h78vxn:hover{background-color:var(--theme-ui-colors-alpha,#667eea);color:var(--theme-ui-colors-white,#fff);}.css-1h78vxn:hover svg{fill:var(--theme-ui-colors-white,#fff);}}.css-1h78vxn:before{display:none;}</style><a href="https://instagram.com/instagram" target="_blank" rel="noopener noreferrer" title="instagram" class="css-1h78vxn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" color="#C13584" style="color:#C13584" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"></path></svg></a><a href="https://twitter.com/twitter" target="_blank" rel="noopener noreferrer" title="twitter" class="css-1h78vxn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" color="#1DA1F2" style="color:#1DA1F2" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><a href="https://example.com" target="_blank" rel="noopener noreferrer" title="website" class="css-1h78vxn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" color="darkslategray" style="color:darkslategray" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"></path></svg></a></div></div></div></div><div class="css-1b24wpc"></div><div class="css-4p9r15"><style data-emotion-css="jw76fk">.css-jw76fk{box-sizing:border-box;margin:0;min-width:0;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:end;-webkit-box-align:end;-ms-flex-align:end;align-items:end;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-jw76fk"><style data-emotion-css="1uzv5xi">.css-1uzv5xi{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1.5rem;color:var(--theme-ui-colors-omegaDark,#718096);margin-left:auto;margin-right:auto;margin-bottom:0;}</style><h2 class="css-1uzv5xi">Topics</h2></div><div class="css-1b24wpc"></div><div class="css-vurnku"><style data-emotion-css="u6a2i2">.css-u6a2i2{box-sizing:border-box;margin:0;min-width:0;-webkit-appearance:none;-moz-appearance:none;appearance:none;display:inline-block;text-align:center;line-height:inherit;-webkit-text-decoration:none;text-decoration:none;font-size:inherit;padding-left:1rem;padding-right:1rem;padding-top:0.5rem;padding-bottom:0.5rem;color:var(--theme-ui-colors-white,#fff);background-color:primary;border:0;border-radius:4px;background-color:var(--theme-ui-colors-contentBg,#fff);border-radius:1rem;-webkit-transition: -webkit-transform 250ms ease, box-shadow 250ms ease, color 250ms ease;-webkit-transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;box-shadow:1px 1px 5px 0 rgba(1,1,1,.05);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;text-align:initial;overflow:hidden;margin-bottom:1rem;padding:0;padding-right:0.5rem;}.css-u6a2i2 svg{color:var(--theme-ui-colors-omegaDark,#718096);vertical-align:middle;width:24px;height:24px;}.css-u6a2i2:hover svg{color:var(--theme-ui-colors-white,#fff);}.css-u6a2i2:hover div:first-of-type{background-color:var(--theme-ui-colors-alpha,#667eea);}</style><a class="css-u6a2i2" href="/category/deeplearing/"><style data-emotion-css="1rl87uo">.css-1rl87uo{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-transition:all 250ms ease;transition:all 250ms ease;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-self:stretch;-ms-flex-item-align:stretch;align-self:stretch;background-color:var(--theme-ui-colors-omegaLight,#e2e8f0);width:70px;}@media screen and (min-width:640px){.css-1rl87uo{display:none;}}@media screen and (min-width:768px){.css-1rl87uo{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}}</style><div class="css-1rl87uo"></div><style data-emotion-css="1sgrski">.css-1sgrski{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1rem;-webkit-flex:auto;-ms-flex:auto;flex:auto;color:var(--theme-ui-colors-omegaDark,#718096);white-space:nowrap;padding:1rem;margin:0;}</style><span class="css-1sgrski">deeplearing</span></a><a class="css-u6a2i2" href="/category/others/"><div class="css-1rl87uo"></div><span class="css-1sgrski">others</span></a></div></div><div class="css-1b24wpc"></div><style data-emotion-css="bdiflm">.css-bdiflm{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;position:-webkit-sticky;position:sticky;top:2rem;}</style><div class="css-bdiflm"><div class="css-4p9r15"><div class="css-jw76fk"><h2 class="css-1uzv5xi">Related Posts</h2></div><div class="css-1b24wpc"></div><style data-emotion-css="116hf8s">.css-116hf8s{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin:-0.5rem;}.css-116hf8s .blog_card{max-width:none;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;padding:0.5rem;}</style><div class="css-116hf8s"><style data-emotion-css="756xbo">.css-756xbo{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-basis:100%;-ms-flex-preferred-size:100%;flex-basis:100%;}</style><div class="blog_card css-756xbo"><style data-emotion-css="12blpch">.css-12blpch{box-sizing:border-box;margin:0;min-width:0;background-color:var(--theme-ui-colors-contentBg,#fff);border-radius:1rem;-webkit-transition: -webkit-transform 250ms ease, box-shadow 250ms ease, color 250ms ease;-webkit-transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;transition: transform 250ms ease, box-shadow 250ms ease, color 250ms ease;box-shadow:1px 1px 5px 0 rgba(1,1,1,.05);overflow:hidden;height:100%;}@media (hover:hover) and (pointer:fine){.css-12blpch:hover{-webkit-transform:translateY(-0.25rem);-ms-transform:translateY(-0.25rem);transform:translateY(-0.25rem);box-shadow: 0px 2px 4px rgba(46,41,51,0.08), 0px 5px 10px rgba(71,63,79,0.16);}}</style><div class="css-12blpch"><style data-emotion-css="l5ycrh">.css-l5ycrh{box-sizing:border-box;margin:0;min-width:0;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;height:100%;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;border-left-style:solid;border-left-width:5px;border-left-color:var(--theme-ui-colors-alphaLight,#a3bffa);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><article class="css-l5ycrh"><style data-emotion-css="1lcwvjb">.css-1lcwvjb{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex:1;-ms-flex:1;flex:1;min-height:100px;padding:1rem;}</style><div class="css-1lcwvjb"><style data-emotion-css="nq00d4">.css-nq00d4{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:0.5rem;font-size:1rem;}</style><a class="css-nq00d4" href="/transferlearning-libtorch/">TransferLearning Libtorch</a><style data-emotion="css zcxndt">.css-zcxndt{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><style data-emotion-css="5zh7cp">.css-5zh7cp{box-sizing:border-box;margin:0;min-width:0;font-size:0.75rem;margin:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-zcxndt css-5zh7cp"><style data-emotion-css="1u093if">.css-1u093if{box-sizing:border-box;margin:0;min-width:0;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;color:var(--theme-ui-colors-omega,#a0aec0);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}</style><div class="css-1u093if"><style data-emotion-css="1urriwz">.css-1urriwz{box-sizing:border-box;margin:0;min-width:0;padding-right:0.5rem;display:inline-block;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;}</style><div class="css-1urriwz"><a class="css-x0ewr6" href="/author/kerry-cho/"><strong>Kerry Cho</strong></a></div><style data-emotion-css="ah2hnh">.css-ah2hnh{box-sizing:border-box;margin:0;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.css-ah2hnh > *:not(:last-child) + *:before{content:" ・ ";}</style><div class="css-ah2hnh"><div class="css-12hibeq">November 27, 2019</div><div class="css-12hibeq"><style data-emotion="css uk6cul">.css-uk6cul{vertical-align:middle;}</style><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="css-uk6cul" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"></path></svg> <!-- -->2<!-- --> min</div></div></div></div></div></article></div></div></div></div></div></div></div></div></div></div><style data-emotion-css="3flha1">.css-3flha1{box-sizing:border-box;margin:0;min-width:0;position:relative;background-color:var(--theme-ui-colors-footerBg,#fff);margin-top:4rem;}@media screen and (min-width:640px){.css-3flha1{margin-top:8rem;}}</style><div class="css-3flha1"><style data-emotion-css="12o0vr3">.css-12o0vr3{box-sizing:border-box;margin:0;min-width:0;width:100%;max-width:1140px;margin-left:auto;margin-right:auto;padding-left:1rem;padding-right:1rem;}@media screen and (min-width:640px){.css-12o0vr3{padding-left:2rem;padding-right:2rem;}}</style><div class="css-12o0vr3"><style data-emotion-css="q7bxia">.css-q7bxia{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:column-reverse;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-top:4rem;padding-bottom:4rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:640px){.css-q7bxia{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;}}</style><div class="css-q7bxia"><div class="css-vurnku"><style data-emotion-css="10xguhx">.css-10xguhx{box-sizing:border-box;margin:0;min-width:0;padding-bottom:0.25rem;margin-bottom:0.5rem;margin-top:2rem;}@media screen and (min-width:640px){.css-10xguhx{margin-top:0;}}</style><div class="css-10xguhx"></div><style data-emotion-css="1ahball">.css-1ahball{box-sizing:border-box;margin:0;min-width:0;padding-top:0.5rem;margin-bottom:0.5rem;}@media screen and (min-width:640px){.css-1ahball{margin-bottom:2rem;}}</style><div class="css-1ahball">© <!-- -->2021<!-- -->, All Rights Reserved.</div></div><div class="css-vurnku"><style data-emotion-css="2blmj0">.css-2blmj0{box-sizing:border-box;margin:0;min-width:0;font-family:'Inter',sans-serif;font-weight:bold;line-height:1.33;display:block;color:var(--theme-ui-colors-heading,#2d3748);font-weight:bold;-webkit-text-decoration:none;text-decoration:none;margin-bottom:1rem;font-size:1rem;display:none;}@media screen and (min-width:640px){.css-2blmj0{display:block;}}</style><p class="css-2blmj0">Quick Links</p><style data-emotion-css="j4toqg">.css-j4toqg{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:640px){.css-j4toqg{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;}}</style><div class="css-j4toqg"><style data-emotion-css="18f2uil">.css-18f2uil{box-sizing:border-box;margin:0;min-width:0;color:inherit;-webkit-text-decoration:none;text-decoration:none;font-weight:700;display:inline-block;color:var(--theme-ui-colors-omegaDark,#718096);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:0.25rem;margin:0;margin-left:0.5rem;margin-right:0.5rem;}.css-18f2uil:hover,.css-18f2uil:focus,.css-18f2uil.active{color:primary;}.css-18f2uil:visited{color:var(--theme-ui-colors-omegaDark,#718096);}.css-18f2uil:hover{color:var(--theme-ui-colors-alpha,#667eea);}.css-18f2uil svg{display:block;margin-left:auto;margin-right:auto;margin-bottom:0.25rem;}@media screen and (min-width:640px){.css-18f2uil{color:var(--theme-ui-colors-omegaDark,#718096);-webkit-text-decoration:none;text-decoration:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-weight:normal;margin-bottom:0.5rem;padding:0;}.css-18f2uil:visited{color:var(--theme-ui-colors-omegaDark,#718096);}.css-18f2uil:hover{color:var(--theme-ui-colors-alpha,#667eea);}.css-18f2uil svg{vertical-align:middle;display:inline-block;margin-right:0.5rem;margin-bottom:0;}}</style><a class="css-18f2uil" href="/about">About Me</a></div></div><div class="css-vurnku"><p class="css-2blmj0">Social Media</p><style data-emotion-css="1ewyfna">.css-1ewyfna{box-sizing:border-box;margin:0;min-width:0;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-bottom:1rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}@media screen and (min-width:640px){.css-1ewyfna{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-flex-wrap:nowrap;-ms-flex-wrap:nowrap;flex-wrap:nowrap;margin-bottom:0;}}</style><div class="css-1ewyfna"><a href="https://github.com/kerry-cho" target="_blank" rel="noopener noreferrer" class="css-18f2uil"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" color="darkslategray" style="color:darkslategray" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>github</a></div></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/image-segmentation-libtorch/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-643fd47f40d2879c29b6.js"],"app":["/app-50f9bf8ab9e951c20863.js"],"component---src-pages-404-jsx":["/component---src-pages-404-jsx-d107080f0655ad9b2bbe.js"],"component---src-pages-about-jsx":["/component---src-pages-about-jsx-d50abbc5cca0d9e65484.js"],"component---src-pages-authors-jsx":["/component---src-pages-authors-jsx-35b4ccef9fa10d659e21.js"],"component---src-pages-contact-jsx":["/component---src-pages-contact-jsx-8fe8283887b435343cee.js"],"component---src-templates-collection-author-js":["/component---src-templates-collection-author-js-7d5d5f45c56caef80abd.js"],"component---src-templates-collection-category-js":["/component---src-templates-collection-category-js-b47ec9d485c7823270cf.js"],"component---src-templates-collection-tag-js":["/component---src-templates-collection-tag-js-168c1c8544ddb3783e32.js"],"component---src-templates-post-js":["/component---src-templates-post-js-3ce6f4158126e723d065.js"],"component---src-templates-posts-js":["/component---src-templates-posts-js-61a0bf19ff545e645a37.js"],"react-slick":["/react-slick-7b6c072f70c579f6db6c.js"]};/*]]>*/</script><script src="/polyfill-643fd47f40d2879c29b6.js" nomodule=""></script><script src="/component---src-templates-post-js-3ce6f4158126e723d065.js" async=""></script><script src="/eec621bf02fd1fb8f4bc6a47ea0801ffe7676c6c-dd14562313247f8bcc61.js" async=""></script><script src="/8318107e3df1ad98495ee7ebb014263547905291-1cf1e072b01392ef1b6a.js" async=""></script><script src="/commons-cbdc30ae181bfc5ae6cc.js" async=""></script><script src="/1bfc9850-8a7d264615bfa63fcb93.js" async=""></script><script src="/app-50f9bf8ab9e951c20863.js" async=""></script><script src="/framework-925a264ea7071e9ed47d.js" async=""></script><script src="/webpack-runtime-5a6ba0d56af91f4a4dff.js" async=""></script></body></html>